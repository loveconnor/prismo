<div class="min-h-screen bg-background flex">
  <!-- Sidebar -->
  @if (!isAuthPage()) {
  <aside class="w-64 border-r border-border bg-background/50 backdrop-blur-sm sticky top-0 h-screen overflow-hidden">
    <app-sidebar>
      <app-sidebar-header>
        <app-sidebar-section>
          <a href="/" class="flex items-center gap-2 px-2 text-base font-semibold text-foreground">
            <img src="/logo/prismo-logo.svg" class="w-7 h-7" alt="Prismo Labs Logo">
            <span>Prismo Labs</span>
          </a>
        </app-sidebar-section>
      </app-sidebar-header>

      <app-sidebar-body>
        <app-sidebar-section>
          <app-sidebar-heading>Main</app-sidebar-heading>
          <app-sidebar-item [current]="isActive('/dashboard')" routerLink="/dashboard">
            <ng-icon name="lucide-house" data-slot="icon" class="size-6"></ng-icon>
            <app-sidebar-label>Home</app-sidebar-label>
          </app-sidebar-item>
          <app-sidebar-item [current]="isActive('/labs')" routerLink="/labs">
            <ng-icon name="lucide-beaker" data-slot="icon" class="size-6"></ng-icon>
            <app-sidebar-label>Labs</app-sidebar-label>
          </app-sidebar-item>
          <app-sidebar-item (click)="openSettings($event)">
            <ng-icon name="lucide-settings" data-slot="icon" class="size-6"></ng-icon>
            <app-sidebar-label>Settings</app-sidebar-label>
          </app-sidebar-item>
          <app-sidebar-item>
            <ng-icon name="lucide-grid-3x3" data-slot="icon" class="size-6"></ng-icon>
            <app-sidebar-label>Sandbox</app-sidebar-label>
          </app-sidebar-item>
        </app-sidebar-section>

        <app-sidebar-divider></app-sidebar-divider>

        <app-sidebar-section>
          <app-sidebar-heading>Coming Soon</app-sidebar-heading>
          <app-sidebar-item [disabled]="true">
            <ng-icon name="lucide-file-text" data-slot="icon" class="size-6"></ng-icon>
            <app-sidebar-label>Review</app-sidebar-label>
          </app-sidebar-item>
          <app-sidebar-item [disabled]="true">
            <ng-icon name="lucide-chart-bar" data-slot="icon" class="size-6"></ng-icon>
            <app-sidebar-label>Analytics</app-sidebar-label>
          </app-sidebar-item>
        </app-sidebar-section>
      </app-sidebar-body>

      <app-sidebar-footer>
        <app-sidebar-section className="px-0 pb-3 flex items-center justify-center">
          @if (authService.currentUser(); as user) {
            <app-avatar-dropdown
              [user]="{
                name: user.profile?.displayName || user.name || user.username || 'User',
                email: user.email,
                role: 'User',
                avatarUrl: user.avatar || 'https://images.unsplash.com/photo-1486297678162-eb2a19b0a32d?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&q=80&w=1473'
              }"
              variant="sidebar"
              (profileClick)="openSettings()"
              (logout)="onLogout()"
            ></app-avatar-dropdown>
          } @else {
            <div class="text-sm text-muted-foreground">Not logged in</div>
          }
        </app-sidebar-section>
      </app-sidebar-footer>
    </app-sidebar>
  </aside>
  }

  <!-- Main Content -->
  <main [class]="isAuthPage() ? 'flex-1' : 'flex-1 overflow-y-auto'">
<router-outlet />
  </main>

  <app-settings-modal [open]="settingsOpen" (openChange)="settingsOpen = $event"></app-settings-modal>
  
  <!-- Toast notifications -->
  <app-toast-container></app-toast-container>
</div>
